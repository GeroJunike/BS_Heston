phi4 = function(u, mat, params, S0, r) 
{
    .e1 <- (0+1i) * u
    .e3 <- .e1 * params[3] * params[4]
    .e4 <- .e3 - params[1]
    .e5 <- params[3]^2
    .e7 <- .e4^2 - u * (0-1i - u) * .e5
    .e8 <- sqrt(.e7)
    .e13 <- 2 * ((0+1i) * .e4 * params[4]) - (0-1i - 2 * u) * 
        params[3]
    .e14 <- (0+1i) * params[4]
    .e16 <- 0.5 * (.e13/.e8)
    .e18 <- params[1] - (.e3 + .e8)
    .e20 <- params[1] + .e8 - .e3
    .e21 <- .e16 - .e14
    .e23 <- exp(-(mat * .e8))
    .e24 <- params[4]^2
    .e26 <- 2 * ((-1+0i) * .e24)
    .e27 <- 2 + .e26
    .e28 <- .e13^2
    .e29 <- .e28/.e7
    .e30 <- 0.5 * .e29
    .e31 <- .e27 - .e30
    .e32 <- .e14 + .e16
    .e33 <- 1 - .e23 * .e18/.e20
    .e34 <- mat * .e18
    .e35 <- 0.5 * .e34
    .e36 <- 0.5 + .e35
    .e37 <- mat * .e13
    .e38 <- .e31/.e8
    .e39 <- .e37/.e8
    .e40 <- 0.5 * .e39
    .e41 <- 0.5 * .e38
    .e42 <- .e21/.e20
    .e43 <- .e42 + .e40
    .e45 <- .e21 * .e18/.e20
    .e46 <- .e36 * .e13
    .e48 <- .e21^2/.e20
    .e51 <- .e43 * .e18 + .e14 + .e16
    .e52 <- .e41 - .e48
    .e54 <- .e45 + .e46/.e8 + .e14
    .e55 <- 1 - .e23
    .e56 <- .e32 * .e21
    .e57 <- .e52 * .e18
    .e58 <- mat * .e32
    .e59 <- (.e33 * .e5)^2
    .e61 <- 1 - .e18/.e20
    .e63 <- 2 * .e27 - .e29
    .e65 <- .e45 + .e14 + .e16
    .e66 <- .e46/.e7
    .e67 <- 0.5 * .e66
    .e68 <- mat * .e31
    .e69 <- .e33 * .e20
    .e70 <- 0.5 * .e31
    .e71 <- .e57 - .e56
    .e72 <- .e68/.e8
    .e73 <- .e58 * .e13
    .e74 <- params[3]^4
    .e75 <- 0.5 * .e63
    .e76 <- 0.5 * .e73
    .e77 <- .e71/.e20
    .e78 <- 0.5 * .e72
    .e79 <- .e75 + .e70
    .e80 <- .e36 * .e31
    .e81 <- .e7 * .e8
    .e83 <- .e52/.e20 + .e78
    .e84 <- 0.5 * .e54
    .e85 <- .e51 * .e23
    .e86 <- .e36 * .e27
    .e87 <- .e43 * .e32
    .e88 <- .e83 * .e18
    .e90 <- .e51 * .e33 * .e23
    .e91 <- 0.5 * .e55
    .e92 <- .e90 * .e74
    .e94 <- .e59 * .e21 + 2 * .e92
    .e95 <- .e79 * .e13
    .e96 <- .e84 + 0.5 * .e32
    .e97 <- .e80 - .e76
    .e98 <- mat/.e8
    .e99 <- .e32 * .e13
    .e100 <- 0.5/.e7
    .e101 <- .e32 * .e55
    .e103 <- 0.5 * .e23 - .e91
    .e104 <- mat * .e96
    .e105 <- .e95/.e81
    .e106 <- .e97/.e8
    .e107 <- .e51 * .e54
    .e108 <- .e88 + .e41
    .e109 <- .e65/.e61
    .e110 <- 0.5 * .e105
    .e111 <- .e37 * .e23
    .e113 <- .e107 * .e23/.e33
    .e114 <- .e13 * .e31
    .e116 <- 0.5 * .e98 + .e100
    .e117 <- .e65^2
    .e118 <- .e117/.e61
    .e119 <- .e77 + .e106
    .e120 <- .e38 - .e48
    .e122 <- .e86 - (.e67 + 0.5 * .e58) * .e13
    .e124 <- 0.5 * (.e111 * .e18/.e8) - .e101
    .e127 <- .e120 * .e21/.e20
    .e128 <- .e57 - (.e113 + .e56)
    .e129 <- mat * .e54
    .e130 <- .e127 + .e110
    .e131 <- .e116 * .e28
    .e134 <- .e54 * .e23/.e33 - .e109
    .e135 <- .e130 * .e18
    .e137 <- .e32 * .e52
    .e138 <- .e57 - (.e118 + .e56)
    .e139 <- .e114/.e7
    .e140 <- .e94 * .e54
    .e141 <- .e33 * params[3]
    .e144 <- .e40 - .e51 * .e55/.e69
    .e145 <- .e122/.e8
    .e146 <- .e59 * .e20
    .e147 <- .e128/.e20
    .e148 <- 0.5 * .e139
    .e149 <- .e27 - .e131
    .e150 <- .e108 - .e87
    .e152 <- (-4+0i) * .e24 + 4
    .e157 <- 0.5 * (.e149 * .e18 - .e99) - 0.5 * .e99
    .e159 <- 0.5 * (.e55 * .e31)
    .e160 <- .e140/.e59
    .e162 <- .e138/.e20 + .e41
    .e163 <- mat * .e157
    .e164 <- .e162/.e61
    .e166 <- .e141^2
    .e167 <- .e57 - (.e160 + .e56)
    .e170 <- .e129 * .e103 * .e13/.e8
    .e171 <- .e27 - .e29
    .e173 <- .e54 * .e32 * .e55
    .e174 <- .e167/.e20
    .e176 <- .e21 * .e33
    .e177 <- .e36 * .e171
    .e178 <- .e86 - (.e67 + .e104) * .e13
    .e179 <- .e152 - .e30
    .e181 <- .e163 * .e23 - .e159
    .e182 <- .e77 + .e145
    .e183 <- .e177 - .e76
    .e184 <- .e80 - .e104 * .e13
    .e186 <- .e134 * .e21/.e20
    .e188 <- log(S0) + mat * r
    .e189 <- .e51 * .e124
    .e190 <- .e184/.e8
    .e191 <- 0.5 * .e183
    .e192 <- .e179 * .e36
    .e193 <- .e51 * .e21
    .e194 <- .e85/.e20
    .e195 <- .e67 + .e58
    .e196 <- mat * .e51
    .e197 <- (0+1i) * .e188
    .e198 <- .e196 * .e13
    .e199 <- .e186 + .e164
    .e203 <- .e51^2 * .e23/.e69 + .e87
    .e206 <- .e144 * .e23 * .e18 - .e101
    .e207 <- 0.5 * (mat * .e33 * .e13/.e8)
    .e212 <- .e85 + .e176
    .e214 <- .e85/.e33 - .e109
    .e216 <- 0.5 * (.e114/.e8)
    .e218 <- 2 * ((.e194 - .e207) * .e51 + .e150 * .e33) + 2 * 
        (.e193 * .e33/.e20)
    .e219 <- .e147 + .e190
    .e226 <- .e218 * .e23 * .e74 + 0.5 * (.e59 * .e31/.e8)
    .e227 <- 0.25 * .e38
    .e228 <- 0.5 * (.e32 * .e27 + .e216)
    .e229 <- .e192 - (.e67 + 2 * .e104) * .e13
    .e232 <- .e135 + .e71 * .e21/.e20 + .e137 + .e148
    .e233 <- .e147 + .e178/.e8
    .e234 <- .e108 - .e203
    .e235 <- 0.5 * .e119
    .e236 <- .e232/.e20
    .e238 <- .e219 * .e23/.e33
    .e239 <- .e182 * .e55
    .e240 <- .e234 * .e54
    .e241 <- .e195 * .e27
    .e242 <- 0.5 * .e122
    .e243 <- .e229/.e8
    .e245 <- .e212 * .e51/.e69
    .e246 <- .e238 - .e199
    .e247 <- .e119 * .e103
    .e248 <- .e54 * .e226
    .e249 <- .e174 + .e145
    .e250 <- .e77 + .e41
    .e251 <- (.e191 + .e242)/.e7
    .e252 <- .e181/.e8
    .e253 <- .e129 * .e13
    .e255 <- mat * .e23/.e8
    .e256 <- .e189/.e166
    .e257 <- .e85/.e69
    .e259 <- .e128 * .e21/.e20
    .e260 <- 0.25 * .e72
    .e262 <- 0.25 * .e98 + .e100
    .e263 <- 0.5 * .e178
    .e264 <- 2 * .e250
    .e265 <- mat * .e79
    .e266 <- .e245 + .e87
    .e268 <- .e257 + .e40
    .e270 <- .e249 * .e55 + .e170
    .e272 <- .e119 * .e32 + 0.5 * (.e54 * .e31/.e8)
    .e274 <- (.e251 + .e260) * .e13 + .e241
    .e275 <- .e54 * .e103
    .e283 <- (.e57 - (.e56 + 2 * .e118))/.e20 + .e41 + .e264
    .e286 <- (.e124/.e141 - .e54 * .e55 * .e23 * .e18 * params[3]^3/.e146) * 
        params[5] + .e197 - (2 * (.e134/.e20) + .e58) * params[1] * 
        params[2]/params[3]
    .e290 <- .e103/.e7
    .e292 <- .e14 + .e84 + .e16
    .e293 <- 0.5 * .e255
    .e294 <- 2 * .e173
    .e296 <- 2 * (.e116 * .e27) - .e262 * .e28/.e7
    .e298 <- .e198 * .e23/.e8
    .e300 <- .e265 * .e13/.e81
    .e301 <- .e152 - .e131
    .e303 <- .e270 * .e18 - .e173
    .e304 <- .e272 * .e55
    .e305 <- .e274/.e8
    .e306 <- .e150 * .e124
    .e308 <- .e138 * .e21/.e20
    .e309 <- .e166 * .e20
    .e312 <- .e296 * .e18 + .e41
    .e314 <- 0.5 * .e290
    .e315 <- .e70 - 0.5 * (.e144 * .e13)
    .e316 <- 2 * .e56
    .e317 <- 2 * .e57
    .e318 <- .e111/.e8
    .e321 <- ((.e283 * .e65/.e61 + .e135 + .e308 + .e137 + .e148)/.e20 + 
        .e110)/.e61
    .e326 <- .e51 * .e206/.e69
    .e328 <- .e119 * .e94 + .e248
    .e329 <- .e239 + .e170
    .e331 <- (.e206 * params[5]/.e33 - (2 * (.e214/.e20) + .e58) * 
        params[1] * params[2])/params[3] + .e197
    .e334 <- .e32 * .e144
    .e335 <- (.e67 + mat * .e292) * .e27
    .e336 <- .e176 + 2 * .e85
    .e337 <- (.e70 - 0.5 * .e198)/.e8
    .e341 <- .e227 + .e235
    .e343 <- 0.5 * (.e301 * .e32 + .e312 * .e13) + .e228
    .e344 <- 0.5 * (.e134 * .e31/.e8)
    .e345 <- .e314 + .e293
    .e346 <- 0.5 * (.e36 * .e63)
    .e347 <- .e191 + .e263
    .e349 <- .e159 + 0.5 * (.e73 * .e23)
    .e350 <- 0.5 * .e298
    .e351 <- 0.5 * .e300
    .e353 <- 0.5 * (.e68 * .e23/.e8) - 0.5 * (.e55 * .e63/.e7)
    .e354 <- 2 * (.e94 * .e55/.e146)
    .e355 <- .e23 - .e91
    .e357 <- mat * .e315/.e8
    .e360 <- .e303 * .e5/.e59 + .e256
    .e362 <- .e214 * .e21/.e20
    .e364 <- .e328 * .e55 + .e140 * (0.5 * .e318 - .e354)
    .e366 <- .e329 * .e18 - .e294
    .e367 <- .e236 + .e305
    .e368 <- .e326 + .e334
    .e370 <- .e189 * .e23/.e69
    .e371 <- .e182 * .e23
    .e372 <- .e54 * .e345
    .e373 <- .e174 + .e106
    .e374 <- .e88 + .e337
    .e376 <- .e347/.e7
    .e377 <- .e349/.e8
    .e378 <- .e33 * .e8
    .e379 <- .e343 + 0.5 * (.e163 * .e13/.e8)
    .e380 <- 0.5 * .e233
    .e381 <- 0.5 * (.e32 * .e31)
    .e382 <- .e192 - .e195 * .e13
    .e383 <- .e243 + (.e317 - (.e113 + .e316))/.e20
    .e384 <- .e243 + 2 * .e147
    .e385 <- (.e364 * .e18 + .e366 * .e94)/.e146
    .e386 <- .e367 * .e55
    .e392 <- (.e51 * (.e77 + .e190) + .e240) * .e23/.e33 + .e135 + 
        .e259 + .e137 + .e148
    .e393 <- .e362 + .e164
    .e394 <- .e373 * .e55
    .e395 <- .e372 * .e13
    .e396 <- .e275 * .e27
    .e397 <- .e33 * .e13
    .e399 <- .e227 + .e380 + .e235
    .e400 <- 0.5 * .e371
    .e401 <- 2 * .e164
    .e403 <- .e253 * .e355/.e8
    .e405 <- mat * .e379 * .e23
    .e407 <- .e382/.e8 + 2 * .e174
    .e409 <- .e383 * .e51 + .e240
    .e412 <- .e384 * .e23/.e33 - (2 * .e186 + .e401)
    .e413 <- .e392/.e20
    .e415 <- (.e394 + .e170) * .e18 - .e173
    .e417 <- (.e247 + .e400 - .e395) * .e13 + .e396
    .e418 <- ((.e21 * (1.5 * .e38 - 2 * .e48)/.e20 + .e110)/.e20 + 
        .e351) * .e18
    .e421 <- .e233 * .e23/.e33 - .e199
    .e422 <- .e239 + .e403
    .e424 <- .e309^2
    .e427 <- ((.e346 + 0.5 * .e97) * .e13/.e7 + mat * (.e381 + 
        .e228))/.e8
    .e430 <- .e108 - .e266
    .e431 <- (0.5 * (.e43 * .e31) + 0.5 * (.e95/.e7))/.e8
    .e433 <- .e79 * .e27 - ((0.5 * (.e7/.e8) + .e8) * .e79/.e8 + 
        0.75 * .e63) * .e28/.e7
    .e434 <- .e27 * .e31
    .e436 <- .e75 + 2 + .e26
    .e437 <- 2 * .e87
    .e438 <- 2 * (.e83 * .e32)
    .e439 <- 2 * .e88
    .e440 <- mu(mat, params, S0, r)
    .e442 <- .e407 * .e55 + 2 * .e170
    .e448 <- .e409 * .e23/.e33 + .e135 + .e259 + .e137 + .e148
    .e450 <- .e412 * .e21 + .e344
    .e452 <- (((.e266 - .e108) * .e55 - .e350)/.e69 + .e357) * 
        .e18 - .e368
    .e458 <- .e268 * .e51
    .e459 <- .e246 * .e21
    .e461 <- (((.e57 - (.e56 + 2 * (.e107 * .e33 * .e23 * .e74/.e59)))/.e20 + 
        .e106) * .e94 + .e248)/.e59
    .e462 <- (.e430 * .e55 + .e350)/.e69
    .e463 <- .e331 * .e286
    .e464 <- .e236 + .e427
    .e465 <- .e51 * .e336
    .e466 <- .e193/.e20
    .e469 <- .e51 * .e181/.e8 + .e306
    .e472 <- .e85 * .e8/.e20 + 0.5 * (.e397/.e8)
    .e474 <- ((.e252 - .e370)/.e33 - .e415 * .e23 * .e74/.e146) * 
        params[5] - (.e78 + 2 * (.e246/.e20)) * params[1] * params[2]
    .e476 <- (.e376 + mat * .e399) * .e13 + .e335
    .e477 <- .e275 * .e31
    .e482 <- .e38 + .e439
    .e484 <- (mat * .e417/.e8 - .e386) * .e18 - (.e385 + .e304 + 
        .e422 * .e32)
    .e485 <- 0.5 * (.e433/.e81)
    .e486 <- 0.5 * (.e353 * .e13)
    .e487 <- 0.5 * (.e253/.e8)
    .e488 <- 2 * .e135
    .e489 <- 2 * .e137
    .e490 <- exp((.e55 * .e18 * params[5]/.e33 + (.e34 - 2 * 
        (log(.e33) - log(.e61))) * params[1] * params[2])/.e5 + 
        .e1 * .e188)
    .e492 <- .e129 * .e32 * .e13
    .e493 <- mat * .e341
    .e495 <- (-6+0i) * .e24 + 6
    .e497 <- .e442 * .e18 - .e294
    .e499 <- .e448/.e20 + .e476/.e8
    .e500 <- .e450/.e20
    .e503 <- (.e452 * .e23 - .e377) * params[5]/.e33 - (.e78 + 
        2 * (((.e108 - (.e458 + .e87)) * .e23/.e33 - .e393)/.e20)) * 
        params[1] * params[2]
    .e504 <- (.e461 + .e135 + .e167 * .e21/.e20 + .e137 + .e148)/.e20
    .e507 <- .e469/.e166 + .e484 * .e5/.e59 - 0.5 * (mat * .e360 * 
        .e13/.e8)
    .e508 <- .e459 + .e344
    .e510 <- ((.e376 + .e493) * .e13 + .e335)/.e8
    .e512 <- .e418 + .e431 + .e438
    .e516 <- .e465 * .e124 * .e33 * .e5/.e424
    .e524 <- (((.e357 - .e462) * .e18 - .e368) * .e23 - .e377) * 
        params[5]/.e33 - (.e78 + 2 * (((.e374 - .e203) * .e23/.e33 - 
        .e393)/.e20)) * params[1] * params[2]
    .e525 <- ((0.5 * (.e120 * .e31/.e8) - (.e105 + 2 * .e127) * 
        .e21)/.e20 + .e485) * .e18
    .e529 <- 0.5 * .e182
    .e530 <- 0.5 * ((.e434 - (.e436 - .e30) * .e28/.e7)/.e7)
    .e531 <- 0.5 * (.e52 * .e31/.e8)
    .e532 <- 0.5 * .e353
    .e533 <- 0.5 * (mat * .e179 * .e32)
    .e534 <- 2 * (.e189 * .e33 * .e23 * .e5/.e309)
    .e535 <- 2 * .e246
    .e536 <- 2 * .e421
    .e537 <- 2 * (.e130 * .e32)
    .e538 <- 2 * .e252
    .e539 <- 3 * .e252
    .e541 <- (.e495 - .e29) * .e36
    .e543 <- .e500 + .e499 * .e23/.e33 - .e321
    .e546 <- .e497 * .e5/.e59 + .e256
    .e547 <- .e503 * .e286
    .e549 <- (.e413 + .e268 * .e219 + ((.e346 + 0.5 * .e184) * 
        .e13/.e7 + mat * (.e341 * .e13 + .e96 * .e27 + .e381))/.e8) * 
        .e23/.e33
    .e551 <- (.e413 + .e268 * .e233 + .e510) * .e23/.e33
    .e553 <- .e507/.e20 - .e516
    .e554 <- (.e472 * .e181/.e378 + .e486 + .e405)/.e378
    .e555 <- .e508/.e20
    .e560 <- (.e51 * (.e252 - .e534) + .e306)/.e166
    .e562 <- (.e194 - 0.5 * (.e397/.e7)) * .e13 + .e33 * .e27
    .e564 <- ((((.e436 - .e29) * .e36 + 0.5 * .e229 + .e263 - 
        .e76)/.e7 + mat * (.e399 + 2 * .e341)) * .e13 + (.e66 + 
        mat * (.e292 + 2 * .e96)) * .e27 + .e533)/.e8
    .e565 <- .e524 * .e286
    .e566 <- (.e336/.e69 + .e40) * .e124
    .e567 <- .e134 * .e13
    .e569 <- .e51 * .e13
    .e570 <- .e150 * .e13
    .e572 <- .e54 * .e13
    .e573 <- .e374 - (.e466 + .e87)
    .e574 <- ((0.5 * (.e181/.e7) + .e532) * .e13 + .e405)/.e8
    .e577 <- .e59 * .e13
    .e578 <- (.e55 * (2 * .e245 + .e437 - .e482) - .e298)/.e69
    .e579 <- (0.5 * (.e492/.e8) + 2 * (.e303 * .e51 * .e33 * 
        .e74/.e146)) * .e23
    .e586 <- 0.5 * .e249
    .e587 <- 0.5 * (.e183/.e7)
    .e588 <- .e486 + .e405
    .e589 <- 0.5 * (.e46 * .e63/.e7 + mat * (0.5 * (.e32 * .e171) + 
        .e228))
    .e590 <- 0.5 * (.e33 * .e31/.e8)
    .e591 <- 0.5 * (.e13/.e7)
    .e592 <- 1.5 * .e58
    .e593 <- 1.5 * .e72
    .e594 <- 2 * (.e304 + 0.5 * (.e492 * .e23/.e8))
    .e595 <- 2 * .e113
    .e596 <- .e535 + .e536
    .e597 <- 2 * .e247
    .e598 <- .e317 - (.e160 + .e316)
    .e599 <- 3 * .e173
    .e600 <- 3 * .e118
    .e601 <- 3 * .e174
    .e602 <- 3 * .e56
    .e603 <- 3 * .e57
    .e604 <- 3 * .e170
    ((((((((((((.e466 + .e88 + .e337 - .e87) * .e23 + .e590) * 
        .e51 + .e212 * .e150) * .e55 + (.e51 * (.e318 - 2 * (.e212 * 
        .e55/.e69)) + .e150 * .e55) * .e212)/.e69 + .e512 * .e55 - 
        mat * (0.5 * (.e51 * .e149 + .e570) + 0.5 * .e570) * 
            .e23/.e8)/.e69 - mat * ((0.25 * .e63 + 0.5 * .e315) * 
        .e13/.e7 + 0.5 * (.e144 * .e27 + (.e78 - .e462) * .e13))/.e8) * 
        .e18 - (((((.e578 + 2 * .e357) * .e18 - (.e326 + 2 * 
        .e334)) * .e23 - 2 * .e377) * .e51 + .e430 * .e206)/.e69 + 
        (.e578 + mat * (.e27 - (.e591 + 0.5 * .e144) * .e13)/.e8) * 
            .e32 + (0.5 * (.e144 * .e31) + 0.5 * (mat * .e452 * 
        .e13))/.e8)) * .e23 - ((.e532 - 0.5 * (.e349/.e7)) * 
        .e13 + 0.5 * (mat * (.e32 * (.e27 - 0.5 * (mat * .e28/.e8)) + 
        .e216) * .e23))/.e8) * params[5]/.e33 + (.e351 + 2 * 
        (((.e268 * (.e482 - (.e458 + .e437)) + ((.e374 - .e266) * 
            .e23/.e69 + .e78) * .e51 + .e418 + .e431 + .e438) * 
            .e23/.e33 + (.e214 * .e52 + (((.e27 - (.e591 + 0.5 * 
            .e196) * .e13)/.e8 + .e439 - (.e51 * (.e40 + 2 * 
            .e257) + .e437)) * .e23/.e33 - (.e362 + .e401)) * 
            .e21)/.e20 - .e321)/.e20)) * params[1] * params[2]) * 
        .e286 + ((0.5 * (mat * .e433/.e81) + 2 * (((((.e383 * 
        .e150 + .e119 * .e234 - ((((((((-10+0i) * .e24 + 10 - 
        1.5 * .e29) * .e36 - (.e66 + 5 * .e104) * .e13)/.e8 + 
        (5 * .e57 - (.e595 + 5 * .e56))/.e20) * .e51 + 3 * .e240) * 
        .e23/.e33 + .e135 + .e137 + .e21 * (.e603 - (.e595 + 
        .e602))/.e20 + 1.5 * .e139 + 2 * (.e135 + .e137))/.e20 + 
        .e564) * .e51 + (.e418 + .e51 * (2 * .e150 - (.e212/.e69 + 
        .e40) * .e51) * .e23/.e69 + .e431 + .e438) * .e54 + 0.5 * 
        (mat * .e409 * .e13/.e8))) * .e23/.e33 + (.e128 * .e52 - 
        ((((.e541 - (.e67 + 3 * .e104) * .e13)/.e8 + (.e603 - 
            (.e113 + .e602))/.e20) * .e51 + 2 * .e240) * .e23/.e33 + 
            .e259 + .e139 + .e488 + .e489) * .e21)/.e20 + .e525 + 
        .e530 + .e531 - .e537)/.e20 + (((.e177 + .e263 - .e76)/.e7 + 
        mat * (.e77 + ((.e35 + 1.25) * .e31 - .e76)/.e8 + .e380)) * 
        .e27 - ((.e347 * .e13/.e7 + 0.5 * .e476 + 0.5 * ((.e587 + 
        .e493) * .e13 + .e335) + .e589)/.e7 + mat * (0.25 * .e105 + 
        0.5 * .e499 + 0.5 * (.e413 + .e510) + 0.5 * .e464)) * 
        .e13)/.e8) * .e23/.e33 + ((0.5 * (.e412 * .e31) + 0.5 * 
        ((.e238 - (.e164 + 0.5 * (.e567/.e7))) * .e31 - 0.5 * 
            (.e567 * .e63/.e7)))/.e8 - ((.e384 * .e268 + (.e448 + 
        2 * .e392)/.e20 + .e564) * .e23/.e33 + (2 * .e450 + 2 * 
        .e508)/.e20 - 3 * .e321) * .e21)/.e20 - (((.e162 * .e283 - 
        (((.e283 + 2 * (.e264 - .e117/(.e61 * .e20))) * .e65/.e61 + 
            .e21 * (.e317 - (.e316 + .e600))/.e20 + .e139 + .e488 + 
            .e489)/.e20 + .e105 + 2 * (.e236 + .e110)) * .e65)/.e61 + 
        (.e138 * .e52 - (((.e57 - (.e56 + .e600))/.e20 + .e41 + 
            4 * .e250) * .e65/.e61 + .e308 + .e139 + .e488 + 
            .e489) * .e21)/.e20 + .e525 + .e530 + .e531 - .e537)/.e20 + 
        .e485)/.e61)/.e20)) * params[1] * params[2] - (((((.e573 * 
        .e8 + 0.5 * (.e569/.e8)) * .e23/.e20 + (0.5 * .e562 - 
        2 * (.e472^2/.e33))/.e8) * .e181 - 2 * (.e472 * .e588))/.e378 + 
        0.5 * (.e353 * .e27 - (0.5 * ((.e293 - 2 * (.e55/.e7)) * 
            .e63/.e7) + 0.5 * (mat * (.e79/.e7 + .e78) * .e23/.e8)) * 
            .e28) + mat * ((0.5 * (0.5 * (.e434 - .e79 * .e28/.e7) + 
        0.5 * .e434) + mat * (0.5 * (.e157 * .e27 - (.e343 + 
        0.5 * (.e157 * .e13/.e7)) * .e13) - 0.5 * (.e379 * .e13)))/.e8 + 
        0.5 * (.e312 * .e27 + 0.5 * (.e301 * .e31/.e8) - (((4 * 
            (.e262 * .e27) - (0.375 * .e98 + 1/.e7) * .e28/.e7) * 
            .e18 + 0.5 * (.e79/.e8)) * .e13/.e7 + 2 * (.e32 * 
            .e296)) * .e13)) * .e23)/.e378 + (((((.e482 - (0.5 * 
        (.e569/.e7) + .e437)) * .e181 - .e51 * .e588)/.e8 - (.e512 * 
        .e124 + 2 * (.e469 * .e51 * .e33 * .e23 * .e5/.e309)))/.e166 + 
        ((mat * ((.e400 + .e597 - .e54 * (.e314 + .e255) * .e13) * 
            .e27 - (.e464 * .e103 + (.e119 * .e345 - .e54 * (0.5 * 
            ((.e290 + .e293)/.e7) + 0.5 * (mat * .e116 * .e23/.e8)) * 
            .e13) * .e13 + .e372 * .e27 + (0.5 * .e367 + 0.5 * 
            (.e236 + ((.e251 + mat * (.e227 + .e529)) * .e13 + 
                .e241)/.e8) + 0.5 * (mat * .e119 * .e13/.e8)) * 
            .e23 + 0.5 * (.e417/.e7)) * .e13)/.e8 - ((((.e177 + 
            .e242 - .e76)/.e7 + 0.75 * .e72) * .e27 - ((.e251 + 
            0.25 * (.e265/.e8)) * .e13 + 0.5 * .e274 + 0.5 * 
            ((.e260 + .e587) * .e13 + .e241) + .e589) * .e13/.e7)/.e8 + 
            (.e525 + (0.5 * (.e71 * .e31/.e8) - 2 * (.e232 * 
                .e21))/.e20 + .e530 + .e531 - .e537)/.e20) * 
            .e55) * .e18 - (((.e328 * (.e318 - .e354) + (.e54 * 
            ((2 * (((.e85 - .e176) * .e51 * .e21/.e20 + (.e150 * 
                .e21 + 0.5 * (.e51 * .e31/.e8)) * .e33)/.e20) + 
                2 * ((.e573 * .e23/.e20 - 0.5 * (mat * .e562/.e8)) * 
                  .e51 + .e150 * (2 * .e194 - .e207) - .e512 * 
                  .e33) - 0.5 * (mat * .e218 * .e13/.e8)) * .e23 * 
                .e74 + 0.5 * (((2 * (.e92/.e20) - 0.5 * (.e577/.e7)) * 
                .e31 - 0.5 * (.e577 * .e63/.e7))/.e8)) + 2 * 
            (.e119 * .e226) - .e464 * .e94) * .e55 + .e140 * 
            (0.5 * (mat * .e149 * .e23/.e8) - 2 * (((.e226 - 
                .e94^2/.e146) * .e55 + 0.5 * (mat * .e94 * .e13 * 
                .e23/.e8))/.e146))) * .e18 + .e366 * .e226 + 
            .e94 * ((mat * ((.e247 + (.e529 - .e487) * .e23) * 
                .e13 + .e477)/.e8 - .e386) * .e18 - (.e385 + 
                .e329 * .e32 + .e594)) + 2 * (.e51 * .e484 * 
            .e33 * .e23 * .e74) - .e364 * .e32)/.e146 + ((0.5 * 
            ((.e119 - 0.5 * (.e572/.e7)) * .e31 - 0.5 * (.e572 * 
                .e63/.e7)) + 0.5 * (.e119 * .e31))/.e8 - .e464 * 
            .e32) * .e55 + .e32 * (mat * ((.e247 + .e371 - .e54 * 
            ((0.5 * .e103 + 0.5 * .e355)/.e7 + 1.25 * .e255) * 
            .e13) * .e13 + (.e119 * .e13 + .e54 * .e27) * .e355 + 
            .e396)/.e8 - 2 * .e386) + (0.5 * (.e422 * .e31) + 
            0.5 * (mat * .e272 * .e13 * .e23))/.e8)) * .e5/.e59 - 
        (.e507 * .e21/.e20 + 0.5 * (mat * (.e360 * .e27 + (.e560 + 
            ((mat * ((.e247 + (.e586 - .e487) * .e23) * .e13 + 
                .e477)/.e8 - (.e504 + .e305) * .e55) * .e18 - 
                (.e270 * .e32 + .e304 + .e579)) * .e5/.e59 - 
            0.5 * (.e360 * .e13/.e7)) * .e13)/.e8)))/.e20 - ((((((.e466 + 
        2 * (.e374 - .e87)) * .e23 + .e590) * .e51 + .e150 * 
        .e336) * .e124 + .e465 * .e181/.e8) * .e33 + (.e194 - 
        2 * ((.e166 * .e21 + 2 * (.e90 * .e5)) * .e166 * .e33 * 
            .e20/.e424)) * .e51 * .e336 * .e124) * .e5/.e424 + 
        0.5 * (mat * .e553 * .e13/.e8))) * .e23 * .e5) * params[5]) * 
        params[3]) * params[3] + (.e547 + (.e463 + ((.e539 - 
        2 * .e370)/.e33 - (((((.e541 - (.e67 + .e592) * .e13)/.e8 + 
        .e601) * .e55 + .e604) * .e18 - .e599) * .e5/.e59 + .e256) * 
        .e23 * .e5/.e20) * params[5] - ((.e536 + 4 * .e246)/.e20 + 
        .e593) * params[1] * params[2]) * .e331 + (((.e21 * .e596/.e20 + 
        2 * (.e549 + .e555 - .e321) + 2 * (.e551 + .e555 - .e321))/.e20 + 
        .e300) * params[1] * params[2] - ((.e560 + ((mat * (0.5 * 
        (.e407 * .e13 * .e23) + 2 * ((.e247 - 0.5 * (.e253 * 
        .e23/.e8)) * .e13 + .e477))/.e8 - ((((0.5 * .e382 + .e346 + 
        .e191)/.e7 + .e78) * .e13 + .e241 + .e533)/.e8 + 2 * 
        .e504) * .e55) * .e18 - (.e442 * .e32 + 2 * (.e497 * 
        .e51 * .e33 * .e23 * .e74/.e146) + .e594)) * .e5/.e59 - 
        .e546 * .e43) * .e23 * .e5/.e20 + ((.e51 * (.e539 - .e566) + 
        .e306) * .e23/.e69 + 2 * .e574)/.e33) * params[5]) * 
        params[3] + .e565 + ((.e351 + 2 * (.e543/.e20)) * params[1] * 
        params[2] - (.e553 * .e23 * .e5 + .e554) * params[5]) * 
        params[3]) * .e331 + .e503 * .e474 + (.e463 + ((.e538 - 
        .e370)/.e33 - .e546 * .e23 * .e5/.e20) * params[5] - 
        (.e596/.e20 + .e72) * params[1] * params[2]) * .e524) * 
        .e490 + (0-1i) * ((.e547 + .e331 * (((.e539 - .e370)/.e33 - 
        ((((((.e495 - .e30) * .e36 - (.e66 + .e592) * .e13)/.e8 + 
            .e601) * .e55 + .e604) * .e18 - .e599) * .e5/.e59 + 
            2 * .e256) * .e23 * .e5/.e20) * params[5] + 2 * .e474 + 
        4 * .e463 - ((.e535 + 4 * .e421)/.e20 + .e593) * params[1] * 
        params[2]) + (((2 * .e543 + 2 * (.e500 + .e551 - .e321))/.e20 + 
        .e300) * params[1] * params[2] + 2 * ((.e351 + 2 * ((.e549 + 
        (.e344 + 2 * .e459)/.e20 - .e321)/.e20)) * params[1] * 
        params[2] - (((.e51 * (.e538 - .e566) + .e306) * .e23/.e69 + 
        .e574)/.e33 + ((mat * ((.e247 + (0.5 * .e373 - .e487) * 
        .e23) * .e13 + .e477)/.e8 - (.e504 + .e427) * .e55) * 
        .e18 - (.e415 * (.e94/.e146 + .e40) + (.e394 + .e403) * 
        .e32 + .e304)) * .e23 * .e74/.e146) * params[5]) - ((((.e51 * 
        (.e538 - .e534) + 2 * .e306)/.e166 + ((mat * (.e179 * 
        .e54 * .e103 + ((.e586 + .e529 - .e487) * .e23 + .e597 - 
        .e395) * .e13)/.e8 - ((.e461 + .e21 * .e598/.e20 + .e139 + 
        .e488 + .e489)/.e20 + 2 * .e305) * .e55) * .e18 - (.e385 + 
        ((.e598/.e20 + 2 * .e145) * .e55 + .e253 * (2.5 * .e23 - 
            1)/.e8) * .e32 + .e579 + 2 * .e304)) * .e5/.e59 - 
        .e360 * (.e42 + .e39))/.e20 - .e516) * .e23 * .e5 + 2 * 
        .e554) * params[5]) * params[3] + 3 * (.e331 * .e474 + 
        .e565)) * .e490 + (0-1i) * (((.e181/.e378 - .e360 * .e23 * 
        .e5/.e20) * params[5] + 5 * .e474 + 6 * .e463 - (.e78 + 
        2 * (.e421/.e20)) * params[1] * params[2]) * .e490 + 
        (0-1i) * ((0-1i) * .e440 * psiLogST_Heston(u, mat, params, 
            S0, r) + 4 * .e286 * .e490) * .e440) * .e440) * .e440) * 
        exp((0-1i) * u * .e440)
}

